# TOI17 sequel

[üéâ solution.cpp](./toi17_sequel.cpp)

square root decomposition + quicksum

‡∏ñ‡πâ‡∏≤‡∏™‡∏°‡∏∏‡∏ï‡∏¥‡πÄ‡∏£‡∏≤ ‡∏ó‡∏≥‡∏ï‡∏£‡∏á‡πÜ

```cpp
for (i = L; i <= R: i += step) sum += input[i];
```

‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ `O(question * (n / step))` ‡∏ñ‡πâ‡∏≤ step ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ 1,2,3,4,5 ‡∏Å‡πá‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì `O(question * n)`

‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤

- ‡∏ñ‡πâ‡∏≤ step ‡∏°‡∏±‡∏ô‡∏ô‡πâ‡πà‡∏≠‡∏¢ ‡∏ï‡∏≠‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ï‡πâ‡∏≠‡∏á ‡∏ß‡∏ô for ‡πÄ‡∏¢‡∏≠‡∏∞ (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ç‡∏¢‡∏±‡∏ö‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
- ‡∏ñ‡πâ‡∏≤ step ‡∏°‡∏±‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞ ‡∏ï‡∏≠‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ï‡πâ‡∏≠‡∏á ‡∏ß‡∏ô for ‡∏ô‡πâ‡∏≠‡∏¢ (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ç‡∏¢‡∏±‡∏ö‡∏ó‡∏µ‡∏•‡∏∞‡∏°‡∏≤‡∏Å‡πÜ)

‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÄ‡∏•‡∏¢‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ô‡πâ‡∏≠‡∏¢‡πÜ‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô step=1 ‡∏î‡πâ‡∏ß‡∏¢ quicksum ‡∏õ‡∏Å‡∏ï‡∏¥

- ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤ `step=2` ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡πÄ‡∏Ñ‡∏™‡∏ß‡πà‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏ô `0, 1`
- ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤ `step=3` ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡πÄ‡∏Ñ‡∏™‡∏ß‡πà‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏ô `0, 1, 2`
- ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤ `step=4` ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡πÄ‡∏Ñ‡∏™‡∏ß‡πà‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏ô `0, 1, 2, 3`
- ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤ `step=k` ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏¢‡∏Å‡πÄ‡∏Ñ‡∏™‡∏ß‡πà‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏ô `0, 1, 2, 3, ..., k-2, k-1`

```cpp
quicksum[step, i] = quicksum[step, i - step] + input[i]
```

‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏≥‡∏ñ‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ k ‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏î‡∏µ‡∏´‡∏•‡∏∞ ?

‡∏Å‡πá‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£

- ‡∏ï‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á quicksum ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ñ‡∏∂‡∏á `k` ‡πÉ‡∏ä‡πâ `O(n * k)`
- ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡∏ï‡∏≠‡∏ö `q` ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
  - ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° `< k` ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ô `O(1)` ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏µ quicksum ‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß
  - ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° `> k` ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ô `O(n / k)` ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏ô for
  - worse case ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏•‡∏¢‡πÄ‡∏õ‡πá‡∏ô `O(q * n / k)`

‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏ß‡∏° `= O(n * k) + O(q * n / k) = O(n * (k + q / k))`

‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏ß‡∏°‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏î ‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ `k = sqrt(q)` ‡∏à‡∏∞‡πÑ‡∏î‡πâ `= O(n * (sqrt(q) + sqrt(q)))` ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏™‡∏∏‡∏î‡πÉ‡∏ô worse case ‡πÅ‡∏•‡πâ‡∏ß ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡πÉ‡∏´‡πâ `n = q` ‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô `O(n * sqrt(n))`
